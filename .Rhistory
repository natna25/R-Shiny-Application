#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure, ~ year, trains, sum)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-6
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, avg)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-6
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, average)
?aggregate
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-6
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
percent_delays_causes = aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_management,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by = year, mean)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
percent_delays_causes = aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_management,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by = year, trains , mean)
percent_delays_causes = aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_management,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by = trains$year, mean)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
percent_delays_causes = aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_management,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by =list( trains$year) , mean)
head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
print(percent_cancelled_trains)
library(dplyr)
percent_delays_causes = trains %>% group_by(year)
%>%
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
print(percent_cancelled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
print(total_trains)
print(total_trains_cancelled)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains/total_train_cancelled
print(total_trains)
print(total_train_cancelled)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains
print(total_trains)
print(total_train_cancelled)
print(percent_cancelled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = data.frame(total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
print(total_trains)
print(total_train_cancelled)
print(percent_cancelled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = data.frame(total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains,c(2015,2016,2017,2018))
print(total_trains)
print(total_train_cancelled)
print(percent_cancelled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-12
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = data.frame(year= c(2015,2016,2017,2018), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
print(total_trains)
print(total_train_cancelled)
print(percent_cancelled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
#1-3
total_trains = aggregate(total_num_trips ~ departure_station, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, mean)
#10-11
total_train_cancelled = aggregate(num_of_canceled_trains ~ departure_station, trains, sum)
percent_cancelled_trains = data.frame(year= distinct(trains$departure_station), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
?distinct
#1-3
total_trains = aggregate(total_num_trips ~ departure_station, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, mean)
#10-11
total_train_cancelled = aggregate(num_of_canceled_trains ~ departure_station, trains, sum)
percent_cancelled_trains = data.frame(stations= distinct(tibble(trains$departure_station) ), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
#1-3
total_trains = aggregate(total_num_trips ~ departure_station, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, mean)
#10-11
total_train_cancelled = aggregate(num_of_canceled_trains ~ departure_station, trains, sum)
percent_cancelled_trains = data.frame(stations= distinct(tibble(trains$departure_station) ), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
percent_cancelled_trains
flights = read_csv("data/raw/flights.csv")
airlines = read_csv("data/raw/airlines.csv")
airports = read_csv("data/raw/airports.csv")
flights = read_csv("data/raw/flights.csv")
airlines = read_csv("data/raw/airlines.csv")
airports = read_csv("data/raw/airports.csv")
print(head(flights))
print(head(airlines))
print(head(airports))
total_flights = aggregate(1 ~ airlines, flights, sum)
?count
total_flights = flights %>% groub_by(airlines) %>% tally()
total_flights = flights %>% group_by(airlines) %>% tally()
total_flights = flights %>% group_by(AIRLINE) %>% tally()
total_flights = flights %>% group_by(AIRLINE) %>% tally()
total_flights
,TALLY5
?tally
?filter
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
total_delayed_flights
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(ELAPSED_TIME)
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise( mean(ELAPSED_TIME))
avg_flight_time
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise( avg = mean(ELAPSED_TIME))
avg_flight_time
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise( mean = mean(ELAPSED_TIME))
avg_flight_time
?sumarise
?summarise
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(ELAPSED_TIME)
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(mean(ELAPSED_TIME))
avg_flight_time
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% mean(ELAPSED_TIME)
avg_flight_time
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME))
#fix it
avg_flight_time
avg_flight_distance
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME))
#fix it
avg_flight_time
#avg_flight_distance
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(as.numeric(ELAPSED_TIME)))
#fix it
avg_flight_time
#avg_flight_distance
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME,na.rm=TRUE))
#fix it
avg_flight_time
#avg_flight_distance
total_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = sum(DISTANCE) )
library(readr)
if(getwd() != "C:/School/Ing5/Data Analytics/R-Shiny-Application"){
print("not in correct directory")
}
data_dir = "data/raw/"
trains = read.csv( "data/raw/french-sncf-trains-regularities/full_trains.csv" )
delays = read_csv2("data/raw/french-sncf-trains-regularities/regularite-mensuelle-tgv-aqst.csv")
print(head(trains))
print(head(delays))
trains = data.frame(trains)
delays = data.frame(delays)
train_agg = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ year, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ year, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ year, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ year, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ year, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ year, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ year, trains, mean)
#10-11
total_train_cancelled = aggregate(num_of_canceled_trains ~ year, trains, sum)
percent_cancelled_trains = data.frame(year= c(2015,2016,2017,2018), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
library(dplyr)
#percent_delays_causes = trains %>% group_by(year)
#                                   %>%
#aggregate(list(trains$delay_cause_external_cause,trains$delay_cause_rail_infrastructure,trains$delay_cause_traffic_m#anagement,trains$delay_cause_rolling_stock,trains$delay_cause_station_management,trains$delay_cause_travelers), by #=list( trains$year) , mean)
#
#head(percent_delays_causes)
#save to csv
#make big data frame with all calculated aggregations
train_year_agg  = data.frame()
#1-3
total_trains = aggregate(total_num_trips ~ departure_station, trains, sum)
total_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, sum)
total_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, sum)
#3-4
avg_depart_delays = aggregate(num_late_at_departure ~ departure_station, trains, mean)
avg_arrival_delays = aggregate(num_arriving_late ~ departure_station, trains, mean)
#6-7
total_avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, sum)
total_avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, sum)
#8-9
avg_depart_delay = aggregate(avg_delay_late_on_arrival ~ departure_station, trains, mean)
avg_arrival_delay = aggregate(avg_delay_late_at_departure ~ departure_station, trains, mean)
#10-11
total_train_cancelled = aggregate(num_of_canceled_trains ~ departure_station, trains, sum)
percent_cancelled_trains = data.frame(stations= distinct(tibble(trains$departure_station) ), percent_cancelled =total_trains$total_num_trips/total_train_cancelled$num_of_canceled_trains)
percent_cancelled_trains
flights = read_csv("data/raw/flights.csv")
airlines = read_csv("data/raw/airlines.csv")
airports = read_csv("data/raw/airports.csv")
print(head(flights))
print(head(airlines))
print(head(airports))
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME,na.rm=TRUE))
avg_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = mean(DISTANCE, na.rm=TRUE))
total_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = sum(DISTANCE) )
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME,na.rm=TRUE))
avg_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = mean(DISTANCE, na.rm=TRUE))
total_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = sum(DISTANCE) )
total_flight_distance
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME,na.rm=TRUE))
avg_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = mean(DISTANCE, na.rm=TRUE))
total_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = sum(DISTANCE) )
avg_depart_delay
total_flights = flights %>% group_by(AIRLINE) %>% tally(name="flight_count")
total_delayed_flights = flights %>% group_by(AIRLINE) %>% filter(DEPARTURE_DELAY > 0) %>% tally(name="delay_count")
avg_flight_time = flights %>% group_by(AIRLINE) %>% summarise(duration = mean(ELAPSED_TIME,na.rm=TRUE))
avg_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = mean(DISTANCE, na.rm=TRUE))
total_flight_distance = flights %>% group_by(AIRLINE) %>% summarise(distance = sum(DISTANCE) )
avg_depart_delay = flights %>% group_by(AIRLINE) %>% summarise(delay = mean(DEPARTURE_DELAY,na.rm=TRUE))
avg_arrival_delay = flights %>% group_by(AIRLINE) %>% summarise(delay = mean(ARRIVAL_DELAY,na.rm=TRUE))
